##############################################################################################
#                               Do not edit manually!                                        #
# All changes must be made to associated .yaml metadata file before running 'make bundle.d'. #
##############################################################################################
prometheus/weaviate:
  enabled: true
  rule:
    docker_observer: type == "container" and port == 2112 and any([name, image, command], {# matches "(?i)weaviate"}) and not (command matches "splunk.discovery")
    k8s_observer: type == "port" and port == 2112 and pod.name matches "(?i)weaviate"
  config:
    default:
      config:
        scrape_configs:
          - job_name: 'weaviate'
            metrics_path: /metrics
            scrape_interval: 10s
            static_configs:
              - targets: ['`endpoint`']
            metric_relabel_configs:
              - source_labels: [__name__]
                action: keep
                regex: "(async_operations_running|\
                batch_delete_durations_ms|\
                batch_durations_ms|\
                index_queue_delete_duration_ms|\
                index_queue_paused|\
                index_queue_preload_count|\
                index_queue_preload_duration_ms|\
                index_queue_push_duration_ms|\
                index_queue_search_duration_ms|\
                index_queue_size|\
                index_queue_stale_count|\
                index_queue_vectors_dequeued|\
                index_queue_wait_duration_ms|\
                lsm_active_segments|\
                lsm_bloom_filter_duration_ms|\
                lsm_segment_count|\
                lsm_segment_objects|\
                lsm_segment_size|\
                object_count|\
                objects_durations_ms|\
                requests_total|\
                startup_diskio_throughput|\
                startup_durations_ms|\
                vector_index_durations_ms|\
                vector_index_maintenance_durations_ms|\
                vector_index_operations|\
                vector_index_size|\
                vector_index_tombstone_cleaned|\
                vector_index_tombstone_cleanup_threads|\
                vector_index_tombstones|\
                weaviate_build_info|\
                weaviate_runtime_config_hash|\
                weaviate_runtime_config_last_load_success|\
                weaviate_schema_collections|\
                weaviate_schema_shards|\
                weaviate_internal_sample_memberlist_queue_broadcasts|\
                weaviate_internal_timer_memberlist_gossip|\
                weaviate_internal_counter_raft_apply|\
                weaviate_internal_counter_raft_state_candidate|\
                weaviate_internal_counter_raft_state_follower|\
                weaviate_internal_counter_raft_state_leader|\
                weaviate_internal_counter_raft_transition_heartbeat_timeout|\
                weaviate_internal_gauge_raft_commitNumLogs|\
                weaviate_internal_gauge_raft_leader_dispatchNumLogs|\
                weaviate_internal_gauge_raft_leader_oldestLogAge|\
                weaviate_internal_gauge_raft_peers|\
                weaviate_internal_sample_raft_boltdb_logBatchSize|\
                weaviate_internal_sample_raft_boltdb_logSize|\
                weaviate_internal_sample_raft_boltdb_logsPerBatch|\
                weaviate_internal_sample_raft_boltdb_writeCapacity|\
                weaviate_internal_sample_raft_thread_fsm_saturation|\
                weaviate_internal_sample_raft_thread_main_saturation|\
                weaviate_internal_timer_raft_boltdb_getLog|\
                weaviate_internal_timer_raft_boltdb_storeLogs|\
                weaviate_internal_timer_raft_commitTime|\
                weaviate_internal_timer_raft_fsm_apply|\
                weaviate_internal_timer_raft_fsm_enqueue|\
                weaviate_internal_timer_raft_leader_dispatchLog|\
                weaviate_usage_gcs_operations_total|\
                weaviate_usage_gcs_operation_latency_seconds|\
                weaviate_usage_gcs_resource_count|\
                weaviate_usage_gcs_uploaded_file_size_bytes|\
                weaviate_usage_s3_operations_total|\
                weaviate_usage_s3_operation_latency_seconds|\
                weaviate_usage_s3_resource_count|\
                weaviate_usage_s3_uploaded_file_size_bytes)"
