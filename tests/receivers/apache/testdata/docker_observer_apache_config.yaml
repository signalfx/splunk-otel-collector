extensions:
  docker_observer:
    use_host_bindings: true

receivers:
  discovery:
    embed_receiver_config: true
    receivers:
      apache:
        config:
          endpoint: http://`endpoint`/server-status?auto
        rule: type == "container" and any([name, image, command], {# matches "(?i)(httpd|apache2).*"}) and not (command matches "splunk.discovery")
    watch_observers:
      - docker_observer

exporters:
  debug:
    verbosity: detailed
  otlp_grpc:
    endpoint: "${OTLP_ENDPOINT}"
    tls:
      insecure: true

service:
  telemetry:
    logs:
      level: info
  extensions:
    - docker_observer
  pipelines:
    logs:
      receivers: [discovery]
      exporters: [otlp_grpc, debug]
